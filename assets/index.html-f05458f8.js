import{_ as u,W as d,X as h,Y as n,Z as a,$ as t,a1 as o,a0 as e,C as l}from"./framework-0d71bc9d.js";const k="/blog/assets/prefetch-4a0c57d8.png",g={},m=n("h1",{id:"pre-operation",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#pre-operation","aria-hidden":"true"},"#"),a(" Pre Operation")],-1),_=n("h2",{id:"prefetch",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#prefetch","aria-hidden":"true"},"#"),a(" PreFetch")],-1),b=n("p",null,"Reference",-1),v={href:"https://developer.mozilla.org/en-US/docs/Web/HTML/Attributes/rel/prefetch",target:"_blank",rel:"noopener noreferrer"},f={href:"https://nitropack.io/blog/post/resource-hints-performance-optimization",target:"_blank",rel:"noopener noreferrer"},q=n("ul",null,[n("li",null,"PreFetch：提前获取后续可能需要的资源，并存储在磁盘中。需要此资源时，该资源以缓存的形式加载。")],-1),x=n("div",{class:"language-html line-numbers-mode","data-ext":"html"},[n("pre",{class:"language-html"},[n("code",null,[n("span",{class:"token tag"},[n("span",{class:"token tag"},[n("span",{class:"token punctuation"},"<"),a("head")]),n("span",{class:"token punctuation"},">")]),a(`
  `),n("span",{class:"token tag"},[n("span",{class:"token tag"},[n("span",{class:"token punctuation"},"<"),a("link")]),a(),n("span",{class:"token attr-name"},"rel"),n("span",{class:"token attr-value"},[n("span",{class:"token punctuation attr-equals"},"="),n("span",{class:"token punctuation"},'"'),a("prefetch"),n("span",{class:"token punctuation"},'"')]),a(),n("span",{class:"token attr-name"},"href"),n("span",{class:"token attr-value"},[n("span",{class:"token punctuation attr-equals"},"="),n("span",{class:"token punctuation"},'"'),a("next.html"),n("span",{class:"token punctuation"},'"')]),n("span",{class:"token punctuation"},"/>")]),a(`
`),n("span",{class:"token tag"},[n("span",{class:"token tag"},[n("span",{class:"token punctuation"},"</"),a("head")]),n("span",{class:"token punctuation"},">")]),a(`
`),n("span",{class:"token tag"},[n("span",{class:"token tag"},[n("span",{class:"token punctuation"},"<"),a("body")]),n("span",{class:"token punctuation"},">")]),a(`
  `),n("span",{class:"token tag"},[n("span",{class:"token tag"},[n("span",{class:"token punctuation"},"<"),a("a")]),a(),n("span",{class:"token attr-name"},"href"),n("span",{class:"token attr-value"},[n("span",{class:"token punctuation attr-equals"},"="),n("span",{class:"token punctuation"},'"'),a("./next.html"),n("span",{class:"token punctuation"},'"')]),n("span",{class:"token punctuation"},">")]),a("nav to next"),n("span",{class:"token tag"},[n("span",{class:"token tag"},[n("span",{class:"token punctuation"},"</"),a("a")]),n("span",{class:"token punctuation"},">")]),a(`
`),n("span",{class:"token tag"},[n("span",{class:"token tag"},[n("span",{class:"token punctuation"},"</"),a("body")]),n("span",{class:"token punctuation"},">")]),a(`
`)])]),n("div",{class:"highlight-lines"},[n("br"),n("div",{class:"highlight-line"}," "),n("br"),n("br"),n("div",{class:"highlight-line"}," "),n("br")]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),P=n("div",{class:"language-html line-numbers-mode","data-ext":"html"},[n("pre",{class:"language-html"},[n("code",null,[n("span",{class:"token tag"},[n("span",{class:"token tag"},[n("span",{class:"token punctuation"},"<"),a("body")]),n("span",{class:"token punctuation"},">")]),a(`
  `),n("span",{class:"token tag"},[n("span",{class:"token tag"},[n("span",{class:"token punctuation"},"<"),a("div")]),n("span",{class:"token punctuation"},">")]),a("next"),n("span",{class:"token tag"},[n("span",{class:"token tag"},[n("span",{class:"token punctuation"},"</"),a("div")]),n("span",{class:"token punctuation"},">")]),a(`
`),n("span",{class:"token tag"},[n("span",{class:"token tag"},[n("span",{class:"token punctuation"},"</"),a("body")]),n("span",{class:"token punctuation"},">")]),a(`
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),C=e('<ul><li>因为配置了 PreFetch，所以浏览器下载 <code>index.html</code> 之后会自动下载 <code>next.html</code> 并存储在磁盘中。需要用到 <code>next.html</code> 资源时从磁盘中访问。</li></ul><figure><img src="'+k+'" alt="PreFetch 的效果" tabindex="0" loading="lazy"><figcaption>PreFetch 的效果</figcaption></figure><ul><li><p>PreFetch 可以在用户鉴权期间使用，提前获取首页资源。</p></li><li><p>一些 <code>Cache-Control</code> （例如：no-cache, no-store）会阻止 PreFetch。</p></li><li><p>PreFetch 相当于携带 <code>priority: false</code> 的 fetch。</p></li></ul><h2 id="dns-prefetch" tabindex="-1"><a class="header-anchor" href="#dns-prefetch" aria-hidden="true">#</a> DNS PreFetch</h2>',4),N=n("p",null,"Reference",-1),F={href:"https://developer.mozilla.org/en-US/docs/Web/Performance/dns-prefetch",target:"_blank",rel:"noopener noreferrer"},S=e(`<ul><li>DNS PreFetch: 在获取资源之前执行域名（domain name）解析。</li></ul><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>dns-prefetch<span class="token punctuation">&quot;</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>https://fonts.googleapis.com/<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>不要用 DNS PreFetch 获取本域的 IP 地址。</li></ul><h2 id="preconnect" tabindex="-1"><a class="header-anchor" href="#preconnect" aria-hidden="true">#</a> PreConnect</h2>`,4),D=n("p",null,"Reference",-1),z={href:"https://developer.mozilla.org/en-US/docs/Web/HTML/Attributes/rel/preconnect",target:"_blank",rel:"noopener noreferrer"},L={href:"https://developer.mozilla.org/en-US/docs/Web/Performance/dns-prefetch#best_practices",target:"_blank",rel:"noopener noreferrer"},M={href:"https://nitropack.io/blog/post/resource-hints-performance-optimization",target:"_blank",rel:"noopener noreferrer"},T=e(`<ul><li>PreConnect: 在获取资源之前与服务器建立连接，包括 DNS 查找、TLS 协商（negotiation）、TCP 握手（handshake）。</li></ul><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>preconnect<span class="token punctuation">&quot;</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>https://fonts.googleapis.com/<span class="token punctuation">&quot;</span></span> <span class="token attr-name">crossorigin</span> <span class="token punctuation">/&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>PreConnect 适合提前获取<strong>少数关键的</strong>资源，如果网站需要与很多第三方域建立连接，那么使用 PreConnect 会起到反作用，这种情况 DNS PreFetch 更合适。</li></ul><h2 id="preload" tabindex="-1"><a class="header-anchor" href="#preload" aria-hidden="true">#</a> PreLoad</h2>`,4),y=n("p",null,"Reference",-1),W={href:"https://nitropack.io/blog/post/link-rel-preload-explained",target:"_blank",rel:"noopener noreferrer"},A={href:"https://developer.mozilla.org/en-US/docs/Web/HTML/Attributes/rel/preload",target:"_blank",rel:"noopener noreferrer"},U=e(`<ul><li>PreLoad: 提前获取在页面渲染过程中才能发现的关键资源。</li></ul><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>preload<span class="token punctuation">&quot;</span></span> <span class="token attr-name">as</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>image<span class="token punctuation">&quot;</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>banner.jpg<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div>`,2),B=n("code",null,"as",-1),H={href:"https://developer.mozilla.org/en-US/docs/Web/HTML/Attributes/rel/preload#what_types_of_content_can_be_preloaded",target:"_blank",rel:"noopener noreferrer"},R=n("li",null,[n("p",null,[a("跨域 PreLoad 需要使用 "),n("code",null,"crossorigin"),a(" 属性。")])],-1),V=e(`<div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>preload<span class="token punctuation">&quot;</span></span> <span class="token attr-name">as</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>image<span class="token punctuation">&quot;</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>banner.jpg<span class="token punctuation">&quot;</span></span> <span class="token attr-name">crossorigin</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div>`,1);function E(I,j){const s=l("ExternalLinkIcon"),c=l("CodeTabs");return d(),h("div",null,[m,_,n("blockquote",null,[b,n("ul",null,[n("li",null,[n("a",v,[a("MDN: PreFetch"),t(s)])]),n("li",null,[n("a",f,[a("resource hints performance optimization"),t(s)])])])]),q,t(c,{id:"30",data:[{title:"index.html"},{title:"next.html"}]},{tab0:o(({title:p,value:r,isActive:i})=>[x]),tab1:o(({title:p,value:r,isActive:i})=>[P]),_:1},8,["data"]),C,n("blockquote",null,[N,n("ul",null,[n("li",null,[n("a",F,[a("MDN: DNS PreFetch"),t(s)])])])]),S,n("blockquote",null,[D,n("ul",null,[n("li",null,[n("a",z,[a("MDN: PreConnect"),t(s)])]),n("li",null,[n("a",L,[a("MDN: PreConnect best practices"),t(s)])]),n("li",null,[n("a",M,[a("Blog: PreConnect"),t(s)])])])]),T,n("blockquote",null,[y,n("ul",null,[n("li",null,[n("a",W,[a("blog: preload"),t(s)])]),n("li",null,[n("a",A,[a("MDN: preload"),t(s)])])])]),U,n("ul",null,[n("li",null,[n("p",null,[B,a(" 用于指定资源的类型，有很多"),n("a",H,[a("选项"),t(s)])])]),R]),V])}const O=u(g,[["render",E],["__file","index.html.vue"]]);export{O as default};
