import{_ as a,W as e,X as t,Y as n,Z as i,$ as o,a0 as l,C as c}from"./framework-c8ebc670.js";const p="/blog/assets/lodash_dt-419e069b.png",r={},d=l(`<h1 id="declaration-files" tabindex="-1"><a class="header-anchor" href="#declaration-files" aria-hidden="true">#</a> Declaration Files</h1><ul><li>TypeScript projects need a way to be told the type shapes of environment-specific features such as global variables and APIs. A project running in, say, Node.js might have access to built-in Node modules not available in browsers—and vice versa.</li><li>TypeScript allows declaring type shapes separately from their implementation.</li><li>Type declarations are typically written in files whose names end with the <code>.d.ts</code> extension, known as declaration files.</li></ul><h2 id="declaration-files-1" tabindex="-1"><a class="header-anchor" href="#declaration-files-1" aria-hidden="true">#</a> Declaration Files</h2><ul><li><code>.d.ts</code> files contain only descriptions of available runtime values, interfaces, modules, and general types. They cannot contain any runtime code that could be compiled down to JavaScript.</li></ul><p><em>person.d.ts</em></p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token comment">// ok</span>
<span class="token keyword">export</span> <span class="token keyword">interface</span> <span class="token class-name">Person</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  age<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// TS1046: Top-level declarations in .d.ts files must start with either a &#39;declare&#39; or &#39;export&#39; modifier.</span>
<span class="token keyword">let</span> a <span class="token operator">=</span> <span class="token boolean">true</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>a<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
  <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>Declaration files can be imported just like any other source TypeScript file.</li></ul><p><em>person.d.ts</em></p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token keyword">export</span> <span class="token keyword">interface</span> <span class="token class-name">Person</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  age<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><em>index.ts</em></p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Person <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;./person&#39;</span>

<span class="token keyword">const</span> person<span class="token operator">:</span> Person <span class="token operator">=</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token string">&#39;eathyn&#39;</span><span class="token punctuation">,</span>
  age<span class="token operator">:</span> <span class="token number">25</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>Declaration files create what’s known as an ambient context, meaning an area of code where you can only declare types, not values.</li></ul><h2 id="declaring-runtime-values" tabindex="-1"><a class="header-anchor" href="#declaring-runtime-values" aria-hidden="true">#</a> Declaring Runtime Values</h2><ul><li>Although definition files may not create runtime values such as functions or variables, they are able to declare that those constructs exist with the <code>declare</code> keyword. Doing so tells the type system that some external influence—such as a <code>&lt;script&gt;</code> tag in a web page—has created the value under that name with a particular type.</li><li>Declaring a variable with <code>declare</code> uses the same syntax as a normal variable declaration, except an initial value is not allowed.</li></ul><p><em>test.d.ts</em></p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token comment">// TS1046: Top-level declarations in .d.ts files must start with either a &#39;declare&#39; or &#39;export&#39; modifier.</span>
<span class="token keyword">let</span> a1<span class="token operator">:</span> <span class="token builtin">string</span>

<span class="token comment">// ok</span>
<span class="token keyword">declare</span> <span class="token keyword">let</span> a2<span class="token operator">:</span> <span class="token builtin">string</span>

<span class="token comment">// TS1039: Initializers are not allowed in ambient contexts.</span>
<span class="token keyword">declare</span> <span class="token keyword">let</span> a3<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token operator">=</span> <span class="token string">&#39;hello&#39;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>Functions and classes are also declared similarly to their normal forms, but without the bodies of functions or methods.</li></ul><p><em>test.d.ts</em></p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token comment">// TS1183: An implementation cannot be declared in ambient contexts.</span>
<span class="token keyword">declare</span> <span class="token keyword">function</span> <span class="token function">f1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token comment">// ok</span>
<span class="token keyword">declare</span> <span class="token keyword">function</span> <span class="token function">f2</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">declare</span> <span class="token keyword">class</span> <span class="token class-name">MyClass</span> <span class="token punctuation">{</span>
  <span class="token comment">// TS1183: An implementation cannot be declared in ambient contexts.</span>
  <span class="token function">f1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

  <span class="token comment">// ok</span>
  <span class="token function">fn2</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>TypeScript’s implicit <code>any</code> rules work the same for functions and variables declared in ambient contexts as they do in normal source code. Explicit return type annotations are generally the only way to stop them from implicitly being type <code>any</code>.</li></ul><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token comment">// return type: any</span>
<span class="token keyword">declare</span> <span class="token keyword">function</span> <span class="token function">f1</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">// return type: string</span>
<span class="token keyword">declare</span> <span class="token keyword">function</span> <span class="token function">f2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">string</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>The <code>declare</code> keyword can be used outside of declaration files</li></ul><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token keyword">declare</span> <span class="token keyword">let</span> a<span class="token operator">:</span> <span class="token builtin">string</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>While type shapes such as interfaces are allowed with or without a <code>declare</code> in <code>.d.ts</code> definition files, runtime constructs such as functions or variables will trigger a type complaint without a <code>declare</code>.</li></ul><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token comment">// ok</span>
<span class="token keyword">declare</span> <span class="token keyword">interface</span> <span class="token class-name">InterfaceOne</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token comment">// ok</span>
<span class="token keyword">interface</span> <span class="token class-name">InterfaceTwo</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token comment">// ok</span>
<span class="token keyword">declare</span> <span class="token keyword">function</span> <span class="token function">f1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">string</span>

<span class="token comment">// TS2391: Function implementation is missing or not immediately following the declaration.</span>
<span class="token keyword">function</span> <span class="token function">f2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">string</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="global-values" tabindex="-1"><a class="header-anchor" href="#global-values" aria-hidden="true">#</a> Global Values</h3><ul><li>Because TypeScript files that have no import or export statements are treated as scripts rather than modules, constructs—including types—declared in them are available globally.</li></ul><p><em>globals.d.ts</em></p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token keyword">declare</span> <span class="token keyword">var</span> version<span class="token operator">:</span> <span class="token builtin">number</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><em>index.ts</em></p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token keyword">function</span> <span class="token function">log</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  global<span class="token punctuation">.</span>version <span class="token operator">=</span> <span class="token number">1</span>
  <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>global<span class="token punctuation">.</span>version<span class="token punctuation">)</span> <span class="token comment">// 1</span>
  <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>version<span class="token punctuation">)</span> <span class="token comment">// 1</span>
<span class="token punctuation">}</span>

<span class="token function">log</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><em>command to compile TS code</em></p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>npx ts-node <span class="token parameter variable">--files</span> .<span class="token punctuation">\\</span>index.ts
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="global-interface-merging" tabindex="-1"><a class="header-anchor" href="#global-interface-merging" aria-hidden="true">#</a> Global Interface Merging</h3><p><em>types_a.ts.d</em></p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token keyword">interface</span> <span class="token class-name">Person</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><em>types_b.ts.d</em></p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token keyword">interface</span> <span class="token class-name">Person</span> <span class="token punctuation">{</span>
  grade<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><em>index.ts</em></p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token comment">// ok</span>
<span class="token keyword">let</span> person1<span class="token operator">:</span> Person <span class="token operator">=</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token string">&#39;eathyn&#39;</span><span class="token punctuation">,</span>
  age<span class="token operator">:</span> <span class="token number">25</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token comment">// TS2741: Property &#39;age&#39; is missing in type &#39;{ name: string; }&#39; but required in type &#39;Person&#39;.</span>
<span class="token keyword">let</span> person2<span class="token operator">:</span> Person <span class="token operator">=</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token string">&#39;eaven&#39;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><em>command</em></p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>npx ts-node <span class="token parameter variable">--files</span> .<span class="token punctuation">\\</span>src<span class="token punctuation">\\</span>index.ts
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="built-in-declarations" tabindex="-1"><a class="header-anchor" href="#built-in-declarations" aria-hidden="true">#</a> Built-In Declarations</h2><ul><li>Global objects such as <code>Array</code> are provided by whatever runtime(s) your code is meant to run in: Deno, Node, a web browser, etc.</li></ul><h3 id="library-declarations" tabindex="-1"><a class="header-anchor" href="#library-declarations" aria-hidden="true">#</a> Library Declarations</h3><ul><li>Built-in global objects exist in all JavaScript runtimes are declared in files with names like <code>lib.[target].d.ts</code>. <code>target</code> is the minimum support version of JavaScript targeted by your project.</li><li>Lib files are distributed as part of the TypeScript npm package.</li><li>IDEs use their own packaged TypeScript versions to type check code.</li></ul><h4 id="library-targets" tabindex="-1"><a class="header-anchor" href="#library-targets" aria-hidden="true">#</a> Library targets</h4><ul><li>Successive lib files for newer versions of JavaScript build on each other using interface merging.</li><li>TypeScript projects will include the lib files for all version targets of JavaScript up through their minimum target. For example, a project with a target of &quot;es2016&quot; would include <code>lib.es5.d.ts</code>, <code>lib.es2015.d.ts</code> and <code>lib.es2016.d.ts</code>.</li></ul><h3 id="dom-declarations" tabindex="-1"><a class="header-anchor" href="#dom-declarations" aria-hidden="true">#</a> DOM Declarations</h3><p>Q : TypeScript includes DOM types by default in projects that don&#39;t override the <code>lib</code> compiler option.</p><h2 id="module-declarations" tabindex="-1"><a class="header-anchor" href="#module-declarations" aria-hidden="true">#</a> Module Declarations</h2><p>Skip : Demo not working</p><h3 id="wildcard-module-declarations" tabindex="-1"><a class="header-anchor" href="#wildcard-module-declarations" aria-hidden="true">#</a> Wildcard Module Declarations</h3><p>Skip : run last demo first</p><h2 id="package-types" tabindex="-1"><a class="header-anchor" href="#package-types" aria-hidden="true">#</a> Package Types</h2><ul><li>Projects written in TypeScript still generally distribute packages containing compiled <code>.js</code> outputs. They typically use <code>.d.ts</code> files to declare the backing TypeScript type system shapes behind those JavaScript files.</li></ul><h3 id="declaration" tabindex="-1"><a class="header-anchor" href="#declaration" aria-hidden="true">#</a> declaration</h3><ul><li>If <code>declaration</code> in <code>tsconfig.json</code> is <code>true</code>, <code>.d.ts</code> and <code>.js</code> files will be generated after compile <code>.ts</code> file.</li></ul><p><em>index.ts</em></p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token keyword">function</span> <span class="token function">add</span><span class="token punctuation">(</span>n1<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">,</span> n2<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> n1 <span class="token operator">+</span> n2
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><em>index.d.ts</em></p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token keyword">declare</span> <span class="token keyword">function</span> <span class="token function">add</span><span class="token punctuation">(</span>n1<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">,</span> n2<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><em>index.js</em></p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token string">&quot;use strict&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token parameter">n1<span class="token punctuation">,</span> n2</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> n1 <span class="token operator">+</span> n2<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="dependency-package-types" tabindex="-1"><a class="header-anchor" href="#dependency-package-types" aria-hidden="true">#</a> Dependency Package Types</h3><ul><li>TypeScript is able to detect and utilize <code>.d.ts</code> files bounded inside a project&#39;s <code>node_modules</code> dependencies. Those files will inform the type system about the type shapes.</li></ul><h3 id="exposing-package-types" tabindex="-1"><a class="header-anchor" href="#exposing-package-types" aria-hidden="true">#</a> Exposing Package Types</h3><ul><li>Package&#39;s <code>package.json</code> file has <code>type</code> and <code>main</code> fields. <code>type</code> field points to the root declaration file.</li></ul><p><em>axios&#39;s package.json</em></p><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;axios&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;main&quot;</span><span class="token operator">:</span> <span class="token string">&quot;index.js&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;index.d.ts&quot;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>The default value of <code>main</code> field in package&#39;s <code>package.json</code> is &#39;./index.js&#39;. The default value of <code>type</code> field in package&#39;s <code>package.json</code> is &#39;./index.d.ts&#39;.</li></ul><h2 id="definitelytyped" tabindex="-1"><a class="header-anchor" href="#definitelytyped" aria-hidden="true">#</a> DefinitelyTyped</h2><ul><li>Not all projects are written in TypeScript. Some unfortunate developers are still writing their projects in plain old JavaScript without a type checker to aid them.</li><li>The TypeScript team and community created a giant repository called <code>DefinitelyTyped</code> to house community-authored definitions for packages.</li><li>DT packages are published on npm under the <code>@types</code> scope with the same name as the package. For example, <code>@types/lodash</code> provides type definitions for the <code>lodash</code> package.</li></ul><figure><img src="`+p+'" alt="Lodash Definitely Typed" tabindex="0" loading="lazy"><figcaption>Lodash Definitely Typed</figcaption></figure><ul><li>If the project is meant to be distributed as a npm package, it should use <code>dependencies</code> so consumers of the package also bring in the type definitions used within. If the project is a standalone application, it should use <code>devDependencies</code> to convey that the types are just a development-time tool.</li></ul><h3 id="type-availability" tabindex="-1"><a class="header-anchor" href="#type-availability" aria-hidden="true">#</a> Type Availability</h3><ul><li>If you’d like to get types for a package that doesn’t yet have types available, your three most common options would be: <ul><li>Send a pull request to DefinitelyTyped to create its <code>@types/</code> package</li><li>Use the <code>declare module</code> syntax to write the types within your project</li><li>Disable <code>noImplicitAny</code></li></ul></li></ul><h2 id="refs" tabindex="-1"><a class="header-anchor" href="#refs" aria-hidden="true">#</a> Refs</h2>',78),u={href:"https://bobbyhadz.com/blog/typescript-declare-global-variable",target:"_blank",rel:"noopener noreferrer"};function m(k,v){const s=c("ExternalLinkIcon");return e(),t("div",null,[d,n("ul",null,[n("li",null,[n("a",u,[i("Global Values"),o(s)])])])])}const h=a(r,[["render",m],["__file","chapter_11.html.vue"]]);export{h as default};
