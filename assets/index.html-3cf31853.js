import{_ as t,W as o,X as p,Y as n,Z as a,$ as e,a0 as l,C as c}from"./framework-0d71bc9d.js";const i="/blog/assets/communication-54e98538.png",u={},r=l('<h1 id="wxs" tabindex="-1"><a class="header-anchor" href="#wxs" aria-hidden="true">#</a> WXS</h1><h2 id="为什么需要-wxs" tabindex="-1"><a class="header-anchor" href="#为什么需要-wxs" aria-hidden="true">#</a> 为什么需要 WXS</h2><ul><li>小程序的运行环境分为渲染层和逻辑层，它们分别由两个线程管理。渲染层由 <code>WebView</code> 渲染，逻辑层由 <code>JS core</code> 线程运行 JS。<code>WXML</code> 和 <code>WXSS</code> 运行在渲染层，<code>JS</code> 运行在逻辑层，渲染层与逻辑层的通信通过微信客户端转发</li></ul><figure><img src="'+i+`" alt="communication" height="400" tabindex="0" loading="lazy"><figcaption>communication</figcaption></figure><ul><li>跨线程通信成本较高，不适合频繁通信的场景。<code>WXS</code> 可以看作是运行在 <code>WebView</code> 中的 <code>JS</code>，优点是不需要跨线程通信</li></ul><h2 id="语法" tabindex="-1"><a class="header-anchor" href="#语法" aria-hidden="true">#</a> 语法</h2><h3 id="介绍" tabindex="-1"><a class="header-anchor" href="#介绍" aria-hidden="true">#</a> 介绍</h3><ul><li>WXS: WeiXin Script</li></ul><h3 id="模块" tabindex="-1"><a class="header-anchor" href="#模块" aria-hidden="true">#</a> 模块</h3><ul><li>wxs 代码可以编写在 wxml 文件的 <code>wxs</code> 标签中或以 <code>wxs</code> 为后缀的文件内</li><li>在 wxml 中调用 wxs 里的函数需要使用 <code>{{ }}</code></li><li>每一个 <code>.wxs</code> 文件和 <code>wxs</code> 标签都是一个单独的模块，即数据为模块私有，需要使用 <code>module.exports</code> 暴露出数据</li></ul><p><em>module_a.wxs</em></p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">1</span>

<span class="token keyword">function</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;fn run...&#39;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">a</span><span class="token operator">:</span> a<span class="token punctuation">,</span>
  <span class="token literal-property property">fn</span><span class="token operator">:</span> fn
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><em>index.wxml</em></p><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code><span class="token comment">&lt;!-- separate wxs file --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>wxs</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>../../wxs/module_a.wxs<span class="token punctuation">&quot;</span></span> <span class="token attr-name">module</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>moduleA<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>

<span class="token comment">&lt;!-- wxs in wxml --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>wxs</span> <span class="token attr-name">module</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>moduleB<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
var b = 2
  
module.exports = {
  b: b
}
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>wxs</span><span class="token punctuation">&gt;</span></span>

<span class="token comment">&lt;!-- a: 1 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span><span class="token punctuation">&gt;</span></span>a: {{ moduleA.a }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>

<span class="token comment">&lt;!-- fn run... --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name"><span class="token namespace">bind:</span>tap</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{{ moduleA.fn }}<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>click me<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>

<span class="token comment">&lt;!-- b: 2 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span><span class="token punctuation">&gt;</span></span>b: {{ moduleB.b }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><code>wxs</code> 使用 <code>require</code> 引用其他 <code>wxs</code></li></ul><p><em>module_a.wxs</em></p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">1</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">a</span><span class="token operator">:</span> a
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><em>module_b.wxs</em></p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">var</span> moduleA <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;./module_a.wxs&#39;</span><span class="token punctuation">)</span>

<span class="token keyword">var</span> b <span class="token operator">=</span> <span class="token number">2</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">a</span><span class="token operator">:</span> moduleA<span class="token punctuation">.</span>a<span class="token punctuation">,</span>
  <span class="token literal-property property">b</span><span class="token operator">:</span> b<span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><em>index.wxml</em></p><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code><span class="token comment">&lt;!-- separate wxs file --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>wxs</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>../../wxs/module_b.wxs<span class="token punctuation">&quot;</span></span> <span class="token attr-name">module</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>moduleB<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span><span class="token punctuation">&gt;</span></span>a: {{ moduleB.a }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span><span class="token punctuation">&gt;</span></span>b: {{ moduleB.b }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="数据类型" tabindex="-1"><a class="header-anchor" href="#数据类型" aria-hidden="true">#</a> 数据类型</h3><ul><li><code>wxs</code> 支持 <code>number</code>, <code>string</code>, <code>boolean</code>, <code>object</code>, <code>function</code>, <code>array</code>, <code>date</code>, <code>regexp</code></li></ul><h3 id="基础类库" tabindex="-1"><a class="header-anchor" href="#基础类库" aria-hidden="true">#</a> 基础类库</h3>`,24),d=n("code",null,"wxs",-1),k={href:"https://developers.weixin.qq.com/miniprogram/dev/reference/wxs/07basiclibrary.html",target:"_blank",rel:"noopener noreferrer"},m=n("h2",{id:"refs",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#refs","aria-hidden":"true"},"#"),a(" Refs")],-1),v={href:"https://www.zhihu.com/question/64322737/answer/223446446",target:"_blank",rel:"noopener noreferrer"},b={href:"https://developers.weixin.qq.com/miniprogram/dev/framework/quickstart/framework.html",target:"_blank",rel:"noopener noreferrer"},g={href:"https://developers.weixin.qq.com/miniprogram/dev/reference/wxs/",target:"_blank",rel:"noopener noreferrer"};function h(x,w){const s=c("ExternalLinkIcon");return o(),p("div",null,[r,n("ul",null,[n("li",null,[d,a(" 的基础类库"),n("a",k,[a("详情"),e(s)])])]),m,n("ul",null,[n("li",null,[n("a",v,[a("Why need WXS"),e(s)])]),n("li",null,[n("a",b,[a("小程序渲染层与逻辑层"),e(s)])]),n("li",null,[n("a",g,[a("WXS Reference"),e(s)])])])])}const _=t(u,[["render",h],["__file","index.html.vue"]]);export{_ as default};
